<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MP3, WAV, OGG">
    <meta name="keywords" content="–∞—É–¥–∏–æ–ø–ª–µ–µ—Ä, –º—É–∑—ã–∫–∞, mp3, wav, ogg, html, css, javascript">
    <meta name="author" content="FufelPlayer">
    <title>FufelPlayer | –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä</title>
    
    <!-- –ò–∫–æ–Ω–∫–∞ —Å–∞–π—Ç–∞ (favicon) –∏–∑ –≤–∞—à–µ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞ -->
    <link rel="icon" type="image/png" href="https://i.postimg.cc/44YgScBQ/Fufel-Spet-no-bg-preview-(carve-photos).png">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            padding: 20px;
            transition: background 0.5s ease;
            position: relative;
        }

        /* –ù–æ–≤–æ–≥–æ–¥–Ω—è—è —Ç–µ–º–∞ */
        body.christmas-theme {
            background: linear-gradient(135deg, #0a2e38, #0d3b2a, #1a1a2e);
        }

        /* –õ–æ–≥–æ—Ç–∏–ø –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É */
        .logo-container {
            position: fixed; /* –ò–∑–º–µ–Ω–µ–Ω–æ —Å absolute –Ω–∞ fixed */
            top: 20px;
            left: 20px;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeInLogo 2s ease;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .logo-container.visible {
            opacity: 1;
            visibility: visible;
        }

        @keyframes fadeInLogo {
            0% { opacity: 0; transform: translateX(-20px); }
            100% { opacity: 1; transform: translateX(0); }
        }

        .logo-img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: contain;
            filter: drop-shadow(0 0 5px rgba(0, 212, 255, 0.5));
            transition: all 0.3s ease;
            cursor: pointer;
            transform-origin: center;
        }

        .logo-img:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.8));
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è –¥–ª—è –ø–∞—Å—Ö–∞–ª–∫–∏ */
        .logo-img.spinning {
            animation: spin 0.3s linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ç–µ–º—ã */
        .theme-switcher {
            position: fixed;
            top: 20px;
            left: 80px;
            display: flex;
            gap: 10px;
            z-index: 1002;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .theme-switcher.visible {
            opacity: 1;
            visibility: visible;
        }

        .theme-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            min-width: 80px;
            text-align: center;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .theme-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .theme-btn.active {
            background: rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .theme-icon {
            font-size: 1rem;
        }

        /* –°–Ω–µ–∂–∏–Ω–∫–∏ - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è */
        #snowflakes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0;
            transition: opacity 1s ease;
            overflow: hidden;
        }

        .snowflake {
            position: absolute;
            background: white;
            border-radius: 50%;
            filter: blur(0.5px);
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            opacity: 0.7;
        }

        body.christmas-theme #snowflakes {
            opacity: 0.6;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π —Ç–µ–º—ã –≤ –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö */
        body.christmas-theme .player-container {
            background: rgba(255, 255,255, 0.08);
        }

        body.christmas-theme .playlist-panel {
            background-color: rgba(10, 46, 56, 0.95);
        }

        body.christmas-theme .progress {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
        }

        body.christmas-theme .play-pause-btn {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
        }

        body.christmas-theme .play-pause-btn:hover {
            background: linear-gradient(135deg, #8BC34A, #4CAF50);
        }

        body.christmas-theme .theme-btn.active {
            background: rgba(76, 175, 80, 0.3);
            color: #8BC34A;
        }

        body.christmas-theme .logo-img {
            filter: drop-shadow(0 0 5px rgba(139, 195, 74, 0.5));
        }

        body.christmas-theme .logo-img:hover {
            filter: drop-shadow(0 0 10px rgba(139, 195, 74, 0.8));
        }

        .welcome-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #0f0c29;
            z-index: 1000;
            opacity: 1;
            visibility: visible;
            transition: opacity 1s ease, visibility 1s ease;
        }

        .welcome-container.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .welcome-logo {
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
            border-radius: 15px;
            object-fit: contain;
            animation: pulse 2s infinite;
            filter: drop-shadow(0 0 15px rgba(0, 212, 255, 0.7));
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .welcome-text {
            font-size: 3.5rem;
            font-weight: 300;
            letter-spacing: 3px;
            color: #fff;
            text-align: center;
            animation: fadeIn 1.5s ease;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(-20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        #visualizer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0;
            transition: opacity 1s ease;
        }

        #visualizer.active {
            opacity: 0.6;
        }

        .main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 800px;
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 1s ease, transform 1s ease;
            transition-delay: 0.5s;
            z-index: 1;
            margin-top: 80px; /* –î–æ–±–∞–≤–ª–µ–Ω–æ —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
        }

        .main-container.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .app-title {
            font-size: 2.8rem;
            font-weight: 300;
            margin-bottom: 40px;
            text-align: center;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1001;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            min-width: 50px;
            text-align: center;
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .lang-btn.active {
            background: rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .controls {
            display: flex;
            gap: 25px;
            margin-bottom: 50px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 16px 32px;
            font-size: 1.2rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
            min-width: 180px;
            text-align: center;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            background-color: rgba(255, 255, 255, 0.2);
        }

        .btn:active {
            transform: translateY(-2px);
        }

        .file-input {
            display: none;
        }

        .playlist-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100%;
            background-color: rgba(15, 12, 41, 0.95);
            z-index: 999;
            padding: 25px;
            overflow-y: auto;
            transition: right 0.5s ease;
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .playlist-panel.open {
            right: 0;
        }

        .playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .playlist-title {
            font-size: 1.8rem;
            font-weight: 300;
        }

        .close-playlist {
            background: none;
            border: none;
            color: #fff;
            font-size: 1.8rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close-playlist:hover {
            color: #00d4ff;
        }

        .playlist-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .playlist-control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 160px;
            justify-content: center;
        }

        .playlist-control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .playlist-control-btn.active {
            background: rgba(0, 212, 255, 0.3);
            color: #00d4ff;
        }

        .playlist {
            list-style: none;
            margin-bottom: 20px;
        }

        .playlist-item {
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .playlist-item.removing {
            transform: translateX(100%);
            opacity: 0;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .playlist-item.active {
            background: rgba(0, 212, 255, 0.2);
            border-left: 4px solid #00d4ff;
        }

        .track-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 220px;
            flex: 1;
        }

        .empty-playlist {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            padding: 40px 20px;
            font-size: 1.1rem;
        }

        .player-container {
            width: 100%;
            max-width: 700px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin-top: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s ease, transform 1s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .player-container.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .track-info {
            text-align: center;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
            height: 50px;
            width: 100%;
        }

        .track-title-container {
            width: 100%;
            overflow: hidden;
            position: relative;
            height: 50px;
            display: flex;
            align-items: center;
        }

        .track-title {
            font-size: 1.8rem;
            font-weight: 400;
            color: #fff;
            position: absolute;
            white-space: nowrap;
            left: 100%;
            transition: left 0.1s linear;
        }

        .track-title.animate {
            animation: marquee 15s linear infinite;
        }

        @keyframes marquee {
            0% {
                left: 100%;
                transform: translateX(0);
            }
            100% {
                left: 0;
                transform: translateX(-100%);
            }
        }

        .progress-container {
            margin-bottom: 25px;
            width: 100%;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-bottom: 10px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            touch-action: none;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #0088ff);
            width: 0%;
            transition: width 0.1s linear;
            position: relative;
        }

        .progress-handle {
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background: #00d4ff;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
            cursor: grab;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .progress-bar:hover .progress-handle,
        .progress-bar.dragging .progress-handle {
            opacity: 1;
        }

        .progress-handle:active {
            cursor: grabbing;
        }

        .time-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            width: 100%;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .play-pause-btn {
            background: linear-gradient(135deg, #00d4ff, #0088ff);
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
        }

        .play-pause-btn:hover {
            background: linear-gradient(135deg, #0088ff, #00d4ff);
        }

        .volume-container, .speed-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            width: 100%;
        }

        .volume-slider, .speed-control {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider input {
            flex: 1;
            height: 6px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
        }

        .volume-slider input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4ff;
            cursor: pointer;
        }

        .speed-control {
            justify-content: center;
        }

        .speed-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .speed-btn:hover {
            background: rgba(0, 212, 255, 0.3);
            transform: scale(1.1);
        }

        .speed-display {
            min-width: 60px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 500;
            color: #00d4ff;
        }

        .loop-btn.active {
            color: #00d4ff;
            background: rgba(0, 212, 255, 0.2);
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
            width: 100%;
        }

        .instructions {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .instructions h3 {
            color: #00d4ff;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .instructions ul {
            list-style: none;
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            position: relative;
        }

        .instructions li:before {
            content: "‚Ä¢";
            color: #00d4ff;
            position: absolute;
            left: -15px;
        }

        .delete-btn {
            background: none;
            border: none;
            color: rgba(255, 100, 100, 0.8);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
        }

        .delete-btn:hover {
            background: rgba(255, 100, 100, 0.1);
            color: #ff6464;
            transform: scale(1.1);
        }

        .support-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .support-section a {
            color: #00d4ff;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .support-section a:hover {
            color: #ffffff;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        .track-title.no-animation {
            animation: none;
            left: 50% !important;
            transform: translateX(-50%) !important;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 212, 255, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 10000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ø–ª–µ–π–ª–∏—Å—Ç–∞ */
        .clear-playlist-btn {
            background: rgba(255, 100, 100, 0.1);
            color: #ff6464;
            border: 1px solid rgba(255, 100, 100, 0.3);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .clear-playlist-btn:hover {
            background: rgba(255, 100, 100, 0.2);
            transform: translateY(-2px);
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */
        .save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .save-indicator.show {
            opacity: 1;
        }

        .donation-section {
            margin-top: 10px;
        }

        .donation-section a {
            color: #ffcc00;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .donation-section a:hover {
            color: #ffdd44;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
        }

        @media (max-width: 768px) {
            .logo-container {
                top: 15px;
                left: 15px;
            }
            
            .logo-img {
                width: 45px;
                height: 45px;
            }
            
            .theme-switcher {
                top: 15px;
                left: 70px;
            }
            
            .theme-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
                min-width: 70px;
            }
            
            .main-container {
                margin-top: 70px;
            }
            
            .welcome-logo {
                width: 80px;
                height: 80px;
            }
            
            .welcome-text {
                font-size: 2.5rem;
            }
            
            .app-title {
                font-size: 2.2rem;
            }
            
            .playlist-panel {
                width: 100%;
                right: -100%;
            }
            
            .player-container {
                padding: 20px;
            }
            
            .track-title {
                font-size: 1.5rem;
            }
            
            .player-controls {
                gap: 15px;
            }
            
            .control-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
            
            .play-pause-btn {
                width: 55px;
                height: 55px;
                font-size: 1.3rem;
            }
            
            .btn {
                padding: 14px 28px;
                font-size: 1.1rem;
                min-width: 160px;
            }
            
            .track-name {
                max-width: 180px;
            }
            
            .language-switcher {
                top: 15px;
                right: 15px;
            }
            
            .lang-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
                min-width: 45px;
            }
            
            .playlist-control-btn {
                padding: 8px 16px;
                font-size: 0.8rem;
                min-width: 140px;
            }
        }

        @media (max-width: 480px) {
            .logo-container {
                top: 10px;
                left: 10px;
            }
            
            .logo-img {
                width: 40px;
                height: 40px;
            }
            
            .theme-switcher {
                top: 10px;
                left: 60px;
            }
            
            .theme-btn {
                padding: 5px 10px;
                font-size: 0.7rem;
                min-width: 65px;
            }
            
            .main-container {
                margin-top: 60px;
            }
            
            .welcome-logo {
                width: 60px;
                height: 60px;
            }
            
            .welcome-text {
                font-size: 2rem;
            }
            
            .app-title {
                font-size: 1.8rem;
            }
            
            .controls {
                gap: 15px;
            }
            
            .btn {
                padding: 12px 24px;
                font-size: 1rem;
                min-width: 140px;
            }
            
            .player-controls {
                gap: 10px;
            }
            
            .control-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .play-pause-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .track-name {
                max-width: 140px;
            }
            
            .language-switcher {
                top: 10px;
                right: 10px;
            }
            
            .playlist-control-btn {
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- –õ–æ–≥–æ—Ç–∏–ø –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
    <div class="logo-container" id="logoContainer">
        <img src="https://i.postimg.cc/44YgScBQ/Fufel-Spet-no-bg-preview-(carve-photos).png" alt="FufelPlayer Logo" class="logo-img" id="secretLogo">
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
    <div class="theme-switcher" id="themeSwitcher">
        <button class="theme-btn active" id="themeNormal">
            <span class="theme-icon">üåô</span>
            <span id="themeNormalText">–û–±—ã—á–Ω–∞—è</span>
        </button>
        <button class="theme-btn" id="themeChristmas">
            <span class="theme-icon">üéÑ</span>
            <span id="themeChristmasText">–ù–æ–≤–æ–≥–æ–¥–Ω—è—è</span>
        </button>
    </div>

    <!-- –°–Ω–µ–∂–∏–Ω–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π —Ç–µ–º—ã) -->
    <div id="snowflakes"></div>

    <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Ñ–æ–Ω–µ -->
    <canvas id="visualizer"></canvas>
    
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
    <div class="welcome-container" id="welcomeContainer">
        <img src="https://i.postimg.cc/44YgScBQ/Fufel-Spet-no-bg-preview-(carve-photos).png" alt="FufelPlayer Logo" class="welcome-logo">
        <h1 class="welcome-text" id="welcomeText">FufelPlayer</h1>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div class="main-container" id="mainContainer">
        <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ -->
        <div class="language-switcher">
            <button class="lang-btn active" id="langRu">RU</button>
            <button class="lang-btn" id="langEn">EN</button>
        </div>
        
        <h1 class="app-title" id="appTitle">FufelPlayer</h1>
        
        <div class="controls">
            <button class="btn" id="uploadBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ</button>
            <button class="btn" id="playlistBtn">–ü–ª–µ–π–ª–∏—Å—Ç</button>
            <button class="btn" id="clearPlaylistBtn" style="background: rgba(255, 100, 100, 0.2); color: #ff6464;">–û—á–∏—Å—Ç–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç</button>
        </div>
        
        <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ -->
        <input type="file" id="fileInput" class="file-input" accept="audio/mp3,audio/wav,audio/ogg,audio/*" multiple>
        
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–ª–µ–µ—Ä–∞ -->
        <div class="player-container" id="playerContainer">
            <div class="track-info">
                <div class="track-title-container">
                    <h2 class="track-title" id="trackTitle">–í—ã–±–µ—Ä–∏—Ç–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</h2>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progressBar">
                    <div class="progress" id="progress">
                        <div class="progress-handle"></div>
                    </div>
                </div>
                <div class="time-info">
                    <span id="currentTime">0:00</span>
                    <span id="duration">0:00</span>
                </div>
            </div>
            
            <div class="player-controls">
                <button class="control-btn loop-btn" id="loopBtn" title="–ü–æ–≤—Ç–æ—Ä —Ç—Ä–µ–∫–∞">‚Üª</button>
                <button class="control-btn" id="prevBtn" title="–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫">‚èÆ</button>
                <button class="control-btn play-pause-btn" id="playPauseBtn" title="–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏">‚ñ∂</button>
                <button class="control-btn" id="nextBtn" title="–°–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫">‚è≠</button>
            </div>
            
            <div class="volume-container">
                <div class="volume-slider">
                    <span>üîä</span>
                    <input type="range" id="volumeSlider" min="0" max="100" value="70" title="–ì—Ä–æ–º–∫–æ—Å—Ç—å">
                    <span id="volumeValue">70%</span>
                </div>
            </div>
            
            <div class="speed-container">
                <div class="speed-control">
                    <button class="speed-btn" id="speedDown" title="–£–º–µ–Ω—å—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å">-</button>
                    <div class="speed-display" id="speedDisplay">1.0x</div>
                    <button class="speed-btn" id="speedUp" title="–£–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å">+</button>
                </div>
            </div>
        </div>
        
        <div class="instructions" id="instructions">
            <h3 id="instructionsTitle">–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:</h3>
            <ul id="instructionsList">
                <li>–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ" –¥–ª—è –≤—ã–±–æ—Ä–∞ MP3, WAV –∏–ª–∏ OGG —Ñ–∞–π–ª–æ–≤</li>
                <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫ –∏–∑ –ø–ª–µ–π–ª–∏—Å—Ç–∞ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</li>
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–∞—É–∑—ã, –ø–µ—Ä–µ–º–æ—Ç–∫–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç—Ä–µ–∫–æ–≤</li>
                <li>–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –ø–æ–ª–∑—É–Ω–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–æ—Ç–∫–∏</li>
                <li>–†–µ–≥—É–ª–∏—Ä—É–π—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</li>
                <li>–í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞ –¥–ª—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è</li>
                <li>–£–¥–∞–ª—è–π—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —Ç—Ä–µ–∫–∏ –∏–∑ –ø–ª–µ–π–ª–∏—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–∫–∏ "√ó"</li>
                <li>–ü–ª–µ–π–ª–∏—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</li>
            </ul>
        </div>
        
        <div class="footer">
            <p id="footerText">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP3, WAV, OGG | ¬© 2025 FufelPlayer: –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            <div class="support-section">
                <p>
                    <span id="supportText">–ü–æ–¥–¥–µ—Ä–∂–∫–∞: </span>
                    <a href="mailto:fufelspet@gmail.com" id="supportEmail">fufelspet@gmail.com</a>
                </p>
                <p class="donation-section">
                    <span id="donationText">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ: </span>
                    <a href="https://www.donationalerts.com/r/fufelspet" target="_blank" id="donationLink">https://www.donationalerts.com/r/fufelspet</a>
                </p>
            </div>
        </div>
    </div>

    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –ø–ª–µ–π–ª–∏—Å—Ç–∞ -->
    <div class="playlist-panel" id="playlistPanel">
        <div class="playlist-header">
            <h2 class="playlist-title" id="playlistTitle">–ü–ª–µ–π–ª–∏—Å—Ç</h2>
            <button class="close-playlist" id="closePlaylist">√ó</button>
        </div>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–µ–π –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–µ–∫–æ–≤ -->
        <div class="playlist-controls">
            <button class="playlist-control-btn" id="toggleAnimationBtn">
                <span id="animationIcon">‚û°Ô∏è</span>
                <span id="animationText">–ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞</span>
            </button>
        </div>
        
        <ul class="playlist" id="playlist">
            <!-- –¢—Ä–µ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </ul>
        
        <div class="empty-playlist" id="emptyPlaylist">
            <p id="emptyPlaylistText">–ü–ª–µ–π–ª–∏—Å—Ç –ø—É—Å—Ç</p>
            <p id="emptyPlaylistHint">–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ", —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã</p>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
            <button class="clear-playlist-btn" id="clearPlaylistPanelBtn">–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –ø–ª–µ–π–ª–∏—Å—Ç</button>
        </div>
    </div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
    <div class="save-indicator" id="saveIndicator">–ü–ª–µ–π–ª–∏—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω</div>

    <script>
        // –¢–µ–∫—Å—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö
        const translations = {
            ru: {
                welcome: "FufelPlayer",
                appTitle: "FufelPlayer",
                uploadBtn: "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ",
                playlistBtn: "–ü–ª–µ–π–ª–∏—Å—Ç",
                playlistTitle: "–ü–ª–µ–π–ª–∏—Å—Ç",
                emptyPlaylistText: "–ü–ª–µ–π–ª–∏—Å—Ç –ø—É—Å—Ç",
                emptyPlaylistHint: "–ù–∞–∂–º–∏—Ç–µ '–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ', —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã",
                trackTitlePlaceholder: "–í—ã–±–µ—Ä–∏—Ç–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è",
                instructionsTitle: "–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:",
                instructionsList: [
                    "–ù–∞–∂–º–∏—Ç–µ '–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ' –¥–ª—è –≤—ã–±–æ—Ä–∞ MP3, WAV –∏–ª–∏ OGG —Ñ–∞–π–ª–æ–≤",
                    "–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫ –∏–∑ –ø–ª–µ–π–ª–∏—Å—Ç–∞ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è",
                    "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–∞—É–∑—ã, –ø–µ—Ä–µ–º–æ—Ç–∫–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç—Ä–µ–∫–æ–≤",
                    "–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –ø–æ–ª–∑—É–Ω–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–æ—Ç–∫–∏",
                    "–†–µ–≥—É–ª–∏—Ä—É–π—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è",
                    "–í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞ –¥–ª—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è",
                    "–£–¥–∞–ª—è–π—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —Ç—Ä–µ–∫–∏ –∏–∑ –ø–ª–µ–π–ª–∏—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–∫–∏ '√ó'",
                    "–ü–ª–µ–π–ª–∏—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã"
                ],
                prevBtnTitle: "–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫",
                nextBtnTitle: "–°–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫",
                playBtnTitle: "–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏",
                pauseBtnTitle: "–ü–∞—É–∑–∞",
                loopBtnTitle: "–ü–æ–≤—Ç–æ—Ä —Ç—Ä–µ–∫–∞",
                loopBtnOffTitle: "–í—ã–∫–ª—é—á–∏—Ç—å –ø–æ–≤—Ç–æ—Ä",
                speedDownTitle: "–£–º–µ–Ω—å—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å",
                speedUpTitle: "–£–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å",
                volumeTitle: "–ì—Ä–æ–º–∫–æ—Å—Ç—å",
                deleteBtnTitle: "–£–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–∫",
                animationEnabled: "–ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞",
                animationDisabled: "–ë–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏",
                footerText: "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP3, WAV, OGG | ¬© 2025 FufelPlayer: –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.",
                supportText: "–ü–æ–¥–¥–µ—Ä–∂–∫–∞: ",
                donationText: "–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ: ",
                trackDeleted: "–¢—Ä–µ–∫ —É–¥–∞–ª–µ–Ω",
                cannotDeletePlaying: "–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π —Ç—Ä–µ–∫. –°–Ω–∞—á–∞–ª–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ.",
                clearPlaylist: "–û—á–∏—Å—Ç–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç",
                clearPlaylistConfirm: "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –ø–ª–µ–π–ª–∏—Å—Ç?",
                playlistCleared: "–ü–ª–µ–π–ª–∏—Å—Ç –æ—á–∏—â–µ–Ω",
                saveIndicator: "–ü–ª–µ–π–ª–∏—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω",
                themeNormal: "–û–±—ã—á–Ω–∞—è",
                themeChristmas: "–ù–æ–≤–æ–≥–æ–¥–Ω—è—è",
                themeChanged: "–¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞"
            },
            en: {
                welcome: "FufelPlayer",
                appTitle: "FufelPlayer",
                uploadBtn: "Upload Audio",
                playlistBtn: "Playlist",
                playlistTitle: "Playlist",
                emptyPlaylistText: "Playlist is empty",
                emptyPlaylistHint: "Click 'Upload Audio' to add files",
                trackTitlePlaceholder: "Select an audio file to play",
                instructionsTitle: "How to use:",
                instructionsList: [
                    "Click 'Upload Audio' to select MP3, WAV or OGG files",
                    "Select a track from the playlist to play",
                    "Use control buttons for pause, rewind and track switching",
                    "Drag progress slider for quick seeking",
                    "Adjust volume and playback speed",
                    "Enable repeat mode for loop playback",
                    "Remove unwanted tracks from playlist using '√ó' button",
                    "Playlist is automatically saved when page reloads"
                ],
                prevBtnTitle: "Previous track",
                nextBtnTitle: "Next track",
                playBtnTitle: "Play",
                pauseBtnTitle: "Pause",
                loopBtnTitle: "Repeat track",
                loopBtnOffTitle: "Disable repeat",
                speedDownTitle: "Decrease speed",
                speedUpTitle: "Increase speed",
                volumeTitle: "Volume",
                deleteBtnTitle: "Delete track",
                animationEnabled: "Marquee enabled",
                animationDisabled: "No animation",
                footerText: "Supported formats: MP3, WAV, OGG | ¬© 2025 FufelPlayer: All rights reserved.",
                supportText: "Support: ",
                donationText: "Donation: ",
                trackDeleted: "Track deleted",
                cannotDeletePlaying: "Cannot delete playing track. Stop playback first.",
                clearPlaylist: "Clear playlist",
                clearPlaylistConfirm: "Are you sure you want to clear the entire playlist?",
                playlistCleared: "Playlist cleared",
                saveIndicator: "Playlist saved",
                themeNormal: "Normal",
                themeChristmas: "Christmas",
                themeChanged: "Theme changed"
            }
        };

        // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
        let currentLang = 'ru';

        // –¢–µ–∫—É—â–∞—è —Ç–µ–º–∞
        let currentTheme = 'normal'; // 'normal' –∏–ª–∏ 'christmas'

        // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã (—á—Ç–æ–±—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)
        let isFirstThemeLoad = true;

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
        let isMarqueeEnabled = true;

        // –î–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        let isDraggingProgress = false;

        // –ü–∞—Å—Ö–∞–ª–∫–∞: —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
        let clickCount = 0;
        let lastClickTime = 0;
        const CLICK_TIMEOUT = 1000; // 1 —Å–µ–∫—É–Ω–¥–∞ –¥–ª—è —Å–µ—Ä–∏–∏ –∫–ª–∏–∫–æ–≤
        const REQUIRED_CLICKS = 5; // –ù—É–∂–Ω–æ 5 –∫–ª–∏–∫–æ–≤

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const welcomeContainer = document.getElementById('welcomeContainer');
        const welcomeText = document.getElementById('welcomeText');
        const mainContainer = document.getElementById('mainContainer');
        const playerContainer = document.getElementById('playerContainer');
        const playlistPanel = document.getElementById('playlistPanel');
        const playlist = document.getElementById('playlist');
        const emptyPlaylist = document.getElementById('emptyPlaylist');
        const visualizer = document.getElementById('visualizer');
        const visualizerCtx = visualizer.getContext('2d');
        const snowflakesContainer = document.getElementById('snowflakes');
        const logoContainer = document.getElementById('logoContainer');
        const themeSwitcher = document.getElementById('themeSwitcher');
        
        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        const uploadBtn = document.getElementById('uploadBtn');
        const playlistBtn = document.getElementById('playlistBtn');
        const closePlaylistBtn = document.getElementById('closePlaylist');
        const fileInput = document.getElementById('fileInput');
        const langRuBtn = document.getElementById('langRu');
        const langEnBtn = document.getElementById('langEn');
        const clearPlaylistBtn = document.getElementById('clearPlaylistBtn');
        const clearPlaylistPanelBtn = document.getElementById('clearPlaylistPanelBtn');
        const secretLogo = document.getElementById('secretLogo');
        
        // –ö–Ω–æ–ø–∫–∏ —Ç–µ–º—ã
        const themeNormalBtn = document.getElementById('themeNormal');
        const themeChristmasBtn = document.getElementById('themeChristmas');
        const themeNormalText = document.getElementById('themeNormalText');
        const themeChristmasText = document.getElementById('themeChristmasText');
        
        // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        const saveIndicator = document.getElementById('saveIndicator');
        
        // –ö–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–µ–π
        const toggleAnimationBtn = document.getElementById('toggleAnimationBtn');
        const animationIcon = document.getElementById('animationIcon');
        const animationText = document.getElementById('animationText');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –ø–ª–µ–µ—Ä–∞
        const trackTitle = document.getElementById('trackTitle');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const loopBtn = document.getElementById('loopBtn');
        const progressBar = document.getElementById('progressBar');
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const volumeSlider = document.getElementById('volumeSlider');
        const volumeValue = document.getElementById('volumeValue');
        const speedDisplay = document.getElementById('speedDisplay');
        const speedDownBtn = document.getElementById('speedDown');
        const speedUpBtn = document.getElementById('speedUp');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
        const appTitle = document.getElementById('appTitle');
        const playlistTitle = document.getElementById('playlistTitle');
        const emptyPlaylistText = document.getElementById('emptyPlaylistText');
        const emptyPlaylistHint = document.getElementById('emptyPlaylistHint');
        const instructionsTitle = document.getElementById('instructionsTitle');
        const instructionsList = document.getElementById('instructionsList');
        const footerText = document.getElementById('footerText');
        const supportText = document.getElementById('supportText');
        const donationText = document.getElementById('donationText');
        const donationLink = document.getElementById('donationLink');
        
        // –ê—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
        let audioContext;
        let analyser;
        let dataArray;
        let bufferLength;
        let animationFrameId;
        
        // –î–ª—è —Å–Ω–µ–∂–∏–Ω–æ–∫
        let snowflakes = [];
        let snowflakeAnimationId;
        
        // –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç
        const audio = new Audio();
        let isPlaying = false;
        let isLooping = false;
        
        // –ü–ª–µ–π–ª–∏—Å—Ç –∏ —Ç–µ–∫—É—â–∏–π —Ç—Ä–µ–∫
        let playlistArray = [];
        let currentTrackIndex = 0;
        
        // –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
        let playbackRate = 1.0;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showNotification(message, duration = 3000) {
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        function showSaveIndicator() {
            saveIndicator.textContent = translations[currentLang].saveIndicator;
            saveIndicator.classList.add('show');
            
            setTimeout(() => {
                saveIndicator.classList.remove('show');
            }, 1500);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–º–µ–Ω—ã —è–∑—ã–∫–∞
        function setLanguage(lang) {
            currentLang = lang;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç—ã
            welcomeText.textContent = translations[lang].welcome;
            appTitle.textContent = translations[lang].appTitle;
            uploadBtn.textContent = translations[lang].uploadBtn;
            playlistBtn.textContent = translations[lang].playlistBtn;
            playlistTitle.textContent = translations[lang].playlistTitle;
            emptyPlaylistText.textContent = translations[lang].emptyPlaylistText;
            emptyPlaylistHint.textContent = translations[lang].emptyPlaylistHint;
            footerText.textContent = translations[lang].footerText;
            supportText.textContent = translations[lang].supportText;
            donationText.textContent = translations[lang].donationText;
            clearPlaylistBtn.textContent = translations[lang].clearPlaylist;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç—ã —Ç–µ–º
            themeNormalText.textContent = translations[lang].themeNormal;
            themeChristmasText.textContent = translations[lang].themeChristmas;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–ª—É—à–∫—É —Ç—Ä–µ–∫–∞, –µ—Å–ª–∏ –Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç—Ä–µ–∫–∞
            if (!audio.src) {
                trackTitle.textContent = translations[lang].trackTitlePlaceholder;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
            instructionsTitle.textContent = translations[lang].instructionsTitle;
            instructionsList.innerHTML = '';
            translations[lang].instructionsList.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                instructionsList.appendChild(li);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–Ω–æ–ø–æ–∫
            prevBtn.setAttribute('title', translations[lang].prevBtnTitle);
            nextBtn.setAttribute('title', translations[lang].nextBtnTitle);
            speedDownBtn.setAttribute('title', translations[lang].speedDownTitle);
            speedUpBtn.setAttribute('title', translations[lang].speedUpTitle);
            volumeSlider.setAttribute('title', translations[lang].volumeTitle);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–Ω–æ–ø–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è/–ø–∞—É–∑—ã
            if (isPlaying) {
                playPauseBtn.setAttribute('title', translations[lang].pauseBtnTitle);
            } else {
                playPauseBtn.setAttribute('title', translations[lang].playBtnTitle);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–Ω–æ–ø–∫–∏ –ø–æ–≤—Ç–æ—Ä–∞
            loopBtn.setAttribute('title', isLooping ? 
                translations[lang].loopBtnOffTitle : 
                translations[lang].loopBtnTitle);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —è–∑—ã–∫–∞
            langRuBtn.classList.toggle('active', lang === 'ru');
            langEnBtn.classList.toggle('active', lang === 'en');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∞–Ω–∏–º–∞—Ü–∏–∏
            updateAnimationButton();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞
            updatePlaylistDisplay();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–º–µ–Ω—ã —Ç–µ–º—ã
        function setTheme(theme) {
            currentTheme = theme;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å body
            document.body.classList.toggle('christmas-theme', theme === 'christmas');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ç–µ–º—ã
            themeNormalBtn.classList.toggle('active', theme === 'normal');
            themeChristmasBtn.classList.toggle('active', theme === 'christmas');
            
            // –£–ø—Ä–∞–≤–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∞–º–∏
            if (theme === 'christmas') {
                createSnowflakes();
                animateSnowflakes();
            } else {
                stopSnowflakes();
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ localStorage
            localStorage.setItem('fufelplayer_theme', theme);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
            if (!isFirstThemeLoad) {
                showNotification(translations[currentLang].themeChanged);
            }
            isFirstThemeLoad = false;
        }
        
        // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–µ–∂–∏–Ω–æ–∫
        function createSnowflakes() {
            snowflakesContainer.innerHTML = '';
            snowflakes = [];
            
            // –£–º–µ–Ω—å—à–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–Ω–µ–∂–∏–Ω–æ–∫ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            const snowflakeCount = Math.min(30, Math.floor(window.innerWidth / 20));
            
            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ—Ç 2 –¥–æ 6 –ø–∏–∫—Å–µ–ª–µ–π (–º–µ–Ω—å—à–µ)
                const size = Math.random() * 4 + 2;
                snowflake.style.width = `${size}px`;
                snowflake.style.height = `${size}px`;
                
                // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
                snowflake.style.left = `${Math.random() * 100}%`;
                snowflake.style.top = `${Math.random() * 100}%`;
                
                // –ú–µ–Ω—å—à–µ —Ç–µ–Ω–∏ –∏ —Ä–∞–∑–º—ã—Ç–∏—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                snowflake.style.opacity = Math.random() * 0.4 + 0.3;
                
                // –ó–∞–º–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
                const speed = Math.random() * 0.5 + 0.3; // –ë—ã–ª–æ 1-3, —Ç–µ–ø–µ—Ä—å 0.3-0.8
                
                // –ë–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–µ –∫–æ–ª–µ–±–∞–Ω–∏–µ
                const sway = Math.random() * 0.5 - 0.25; // –ú–µ–Ω—å—à–µ –∫–æ–ª–µ–±–∞–Ω–∏–π
                const swaySpeed = Math.random() * 0.02 + 0.01; // –ú–µ–¥–ª–µ–Ω–Ω–µ–µ
                
                snowflakes.push({
                    element: snowflake,
                    x: parseFloat(snowflake.style.left),
                    y: parseFloat(snowflake.style.top),
                    size: size,
                    speed: speed,
                    sway: sway,
                    swaySpeed: swaySpeed
                });
                
                snowflakesContainer.appendChild(snowflake);
            }
        }
        
        // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è —Å–Ω–µ–∂–∏–Ω–æ–∫
        function animateSnowflakes() {
            if (currentTheme !== 'christmas') return;
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º FPS –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
            snowflakeAnimationId = requestAnimationFrame(animateSnowflakes);
            
            snowflakes.forEach(snowflake => {
                // –î–≤–∏–≥–∞–µ–º —Å–Ω–µ–∂–∏–Ω–∫—É –≤–Ω–∏–∑ —Å –∑–∞–º–µ–¥–ª–µ–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é
                snowflake.y += snowflake.speed;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ª–µ–≥–∫–æ–µ –∫–æ–ª–µ–±–∞–Ω–∏–µ
                snowflake.x += snowflake.sway * Math.sin(snowflake.y * snowflake.swaySpeed);
                
                // –ï—Å–ª–∏ —Å–Ω–µ–∂–∏–Ω–∫–∞ —É–ø–∞–ª–∞ –∑–∞ –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–µ –Ω–∞–≤–µ—Ä—Ö
                if (snowflake.y > 100) {
                    snowflake.y = -5;
                    snowflake.x = Math.random() * 100;
                }
                
                // –ï—Å–ª–∏ —Å–Ω–µ–∂–∏–Ω–∫–∞ –≤—ã—à–ª–∞ –∑–∞ –±–æ–∫–æ–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã, –ø–µ—Ä–µ–Ω–æ—Å–∏–º –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç–æ—Ä–æ–Ω—É
                if (snowflake.x > 100) snowflake.x = 0;
                if (snowflake.x < 0) snowflake.x = 100;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é
                snowflake.element.style.left = `${snowflake.x}%`;
                snowflake.element.style.top = `${snowflake.y}%`;
            });
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–Ω–µ–∂–∏–Ω–æ–∫
        function stopSnowflakes() {
            if (snowflakeAnimationId) {
                cancelAnimationFrame(snowflakeAnimationId);
                snowflakeAnimationId = null;
            }
            snowflakesContainer.innerHTML = '';
            snowflakes = [];
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –¥–ª—è —Å–Ω–µ–∂–∏–Ω–æ–∫
        function handleResize() {
            if (currentTheme === 'christmas') {
                createSnowflakes();
            }
            visualizer.width = window.innerWidth;
            visualizer.height = window.innerHeight;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
        function updateAnimationButton() {
            if (isMarqueeEnabled) {
                animationIcon.textContent = '‚û°Ô∏è';
                animationText.textContent = translations[currentLang].animationEnabled;
                toggleAnimationBtn.classList.add('active');
            } else {
                animationIcon.textContent = '‚èπÔ∏è';
                animationText.textContent = translations[currentLang].animationDisabled;
                toggleAnimationBtn.classList.remove('active');
            }
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∫ —Ç–µ–∫—É—â–µ–º—É —Ç—Ä–µ–∫—É
        function applyAnimationToTrack() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã –∞–Ω–∏–º–∞—Ü–∏–∏
            trackTitle.classList.remove('animate', 'no-animation');
            
            if (isMarqueeEnabled) {
                trackTitle.classList.add('animate');
            } else {
                trackTitle.classList.add('no-animation');
            }
        }
        
        // =================== –ü–ê–°–•–ê–õ–ö–ê ===================
        secretLogo.addEventListener('click', () => {
            const now = Date.now();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫, –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç–∞–π–º–∞—É—Ç–∞
            if (now - lastClickTime > CLICK_TIMEOUT) {
                clickCount = 0;
            }
            
            clickCount++;
            lastClickTime = now;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏ –Ω—É–∂–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∏–∫–æ–≤
            if (clickCount >= REQUIRED_CLICKS) {
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
                secretLogo.classList.add('spinning');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                clickCount = 0;
                
                // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
                setTimeout(() => {
                    secretLogo.classList.remove('spinning');
                }, 300);
            }
        });
        // ================================================
        
        // =================== –°–û–•–†–ê–ù–ï–ù–ò–ï –ü–õ–ï–ô–õ–ò–°–¢–ê ===================
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –≤ localStorage
        function savePlaylistToStorage() {
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–µ–∫–∞—Ö
                const playlistToSave = playlistArray.map(track => ({
                    id: track.id,
                    name: track.name
                }));
                
                localStorage.setItem('fufelplayer_playlist', JSON.stringify(playlistToSave));
                localStorage.setItem('fufelplayer_currentTrackIndex', currentTrackIndex.toString());
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                showSaveIndicator();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –∏–∑ localStorage
        function loadPlaylistFromStorage() {
            try {
                const savedPlaylist = localStorage.getItem('fufelplayer_playlist');
                const savedIndex = localStorage.getItem('fufelplayer_currentTrackIndex');
                
                if (savedPlaylist) {
                    // –ü–ª–µ–π–ª–∏—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–æ —Ñ–∞–π–ª—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
                    // –ü—Ä–æ—Å—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
                    if (savedIndex) {
                        currentTrackIndex = parseInt(savedIndex);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–µ–π–ª–∏—Å—Ç–∞:', error);
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–ª–µ–π–ª–∏—Å—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
        function savePlaylist() {
            savePlaylistToStorage();
        }
        // ============================================================
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —è–∑—ã–∫–∞
        langRuBtn.addEventListener('click', () => setLanguage('ru'));
        langEnBtn.addEventListener('click', () => setLanguage('en'));
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ç–µ–º—ã
        themeNormalBtn.addEventListener('click', () => setTheme('normal'));
        themeChristmasBtn.addEventListener('click', () => setTheme('christmas'));
        
        // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
        toggleAnimationBtn.addEventListener('click', () => {
            isMarqueeEnabled = !isMarqueeEnabled;
            updateAnimationButton();
            applyAnimationToTrack();
            
            showNotification(
                currentLang === 'ru' 
                ? (isMarqueeEnabled ? "–ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞" : "–ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞")
                : (isMarqueeEnabled ? "Marquee enabled" : "Marquee disabled")
            );
        });
        
        // 1. –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
        setTimeout(() => {
            welcomeContainer.classList.add('hidden');
            
            setTimeout(() => {
                mainContainer.classList.add('visible');
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–≥–æ—Ç–∏–ø –∏ –∫–Ω–æ–ø–∫–∏ —Ç–µ–º –ø–æ—Å–ª–µ —Å–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
                logoContainer.classList.add('visible');
                themeSwitcher.classList.add('visible');
            }, 500);
        }, 1500);
        
        // 2. –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç
        playlistBtn.addEventListener('click', () => {
            playlistPanel.classList.add('open');
        });
        
        closePlaylistBtn.addEventListener('click', () => {
            playlistPanel.classList.remove('open');
        });
        
        // 3. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤
        uploadBtn.addEventListener('click', () => {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', (e) => {
            const files = Array.from(e.target.files);
            
            if (files.length === 0) return;
            
            files.forEach(file => {
                if (!file.type.startsWith('audio/')) {
                    alert(`–§–∞–π–ª "${file.name}" –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–º –∏ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω.`);
                    return;
                }
                
                const track = {
                    id: Date.now() + Math.random(),
                    name: file.name.replace(/\.[^/.]+$/, ""),
                    file: file,
                    url: URL.createObjectURL(file)
                };
                
                playlistArray.push(track);
            });
            
            updatePlaylistDisplay();
            
            // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ç—Ä–µ–∫, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –µ–≥–æ
            if (playlistArray.length > 0 && playlistArray.length === files.length) {
                currentTrackIndex = playlistArray.length - files.length;
                loadTrack(currentTrackIndex);
                playerContainer.classList.add('visible');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–ª–µ–π–ª–∏—Å—Ç
            savePlaylist();
            
            fileInput.value = '';
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ç—Ä–µ–∫–∞
        function removeTrack(trackIndex, element) {
            // –ï—Å–ª–∏ –ø—ã—Ç–∞–µ–º—Å—è —É–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–µ–π—á–∞—Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            if (trackIndex === currentTrackIndex && isPlaying) {
                showNotification(translations[currentLang].cannotDeletePlaying);
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è
            element.classList.add('removing');
            
            // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                // –£–¥–∞–ª—è–µ–º —Ç—Ä–µ–∫ –∏–∑ –º–∞—Å—Å–∏–≤–∞
                playlistArray.splice(trackIndex, 1);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if (trackIndex < currentTrackIndex) {
                    currentTrackIndex--;
                } else if (trackIndex === currentTrackIndex) {
                    // –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ —Ç–µ–∫—É—â–∏–π —Ç—Ä–µ–∫
                    if (playlistArray.length > 0) {
                        // –í—ã–±–∏—Ä–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫ –∏–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π, –µ—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π
                        currentTrackIndex = Math.min(currentTrackIndex, playlistArray.length - 1);
                        loadTrack(currentTrackIndex);
                    } else {
                        // –ï—Å–ª–∏ –ø–ª–µ–π–ª–∏—Å—Ç –ø—É—Å—Ç, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–ª–µ–µ—Ä
                        audio.src = '';
                        trackTitle.textContent = translations[currentLang].trackTitlePlaceholder;
                        playerContainer.classList.remove('visible');
                        pauseTrack();
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞
                updatePlaylistDisplay();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                savePlaylist();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification(translations[currentLang].trackDeleted);
                
            }, 500); // –í—Ä–µ–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∞–Ω–∏–º–∞—Ü–∏–∏ CSS
        }
        
        // 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞
        function updatePlaylistDisplay() {
            playlist.innerHTML = '';
            
            if (playlistArray.length === 0) {
                emptyPlaylist.style.display = 'block';
                return;
            }
            
            emptyPlaylist.style.display = 'none';
            
            playlistArray.forEach((track, index) => {
                const li = document.createElement('li');
                li.className = 'playlist-item';
                if (index === currentTrackIndex) {
                    li.classList.add('active');
                }
                
                // –û–±—Ä–µ–∑–∞–µ–º –¥–ª–∏–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
                let displayName = track.name;
                if (displayName.length > 30) {
                    displayName = displayName.substring(0, 27) + '...';
                }
                
                li.innerHTML = `
                    <span style="margin-right: 10px;">üéµ</span>
                    <span class="track-name" title="${track.name}">${displayName}</span>
                    <button class="delete-btn" data-index="${index}" title="${translations[currentLang].deleteBtnTitle}">
                        √ó
                    </button>
                `;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Ç—Ä–µ–∫—É
                li.addEventListener('click', (e) => {
                    // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è, –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç—Ä–µ–∫
                    if (e.target.classList.contains('delete-btn')) {
                        e.stopPropagation();
                        return;
                    }
                    
                    document.querySelectorAll('.playlist-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    li.classList.add('active');
                    
                    currentTrackIndex = index;
                    loadTrack(currentTrackIndex);
                    
                    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ç—Ä–µ–∫ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
                    playTrack();
                    
                    if (window.innerWidth <= 768) {
                        playlistPanel.classList.remove('open');
                    }
                });
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
                const deleteBtn = li.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const index = parseInt(this.getAttribute('data-index'));
                    removeTrack(index, li);
                });
                
                playlist.appendChild(li);
            });
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ –ø–ª–µ–π–ª–∏—Å—Ç–∞
        function clearPlaylist() {
            if (playlistArray.length === 0) return;
            
            if (confirm(translations[currentLang].clearPlaylistConfirm)) {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
                pauseTrack();
                
                // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤
                playlistArray = [];
                currentTrackIndex = 0;
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∞—É–¥–∏–æ
                audio.src = '';
                trackTitle.textContent = translations[currentLang].trackTitlePlaceholder;
                playerContainer.classList.remove('visible');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                updatePlaylistDisplay();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                savePlaylist();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification(translations[currentLang].playlistCleared);
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ—á–∏—Å—Ç–∫–∏ –ø–ª–µ–π–ª–∏—Å—Ç–∞
        clearPlaylistBtn.addEventListener('click', clearPlaylist);
        clearPlaylistPanelBtn.addEventListener('click', clearPlaylist);
        
        // 5. –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–µ–∫–∞
        function loadTrack(index) {
            if (playlistArray.length === 0) return;
            
            const track = playlistArray[index];
            
            // –ü–∞—É–∑–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ç—Ä–µ–∫
            pauseTrack();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∞—É–¥–∏–æ
            audio.src = '';
            audio.currentTime = 0;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
            audio.src = track.url;
            audio.playbackRate = playbackRate;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞
            trackTitle.textContent = track.name;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é
            trackTitle.style.left = '0';
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
            applyAnimationToTrack();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            progress.style.width = '0%';
            currentTimeEl.textContent = '0:00';
            durationEl.textContent = '0:00';
            
            // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            const onLoadedMetadata = () => {
                durationEl.textContent = formatTime(audio.duration);
            };
            
            audio.addEventListener('loadedmetadata', onLoadedMetadata, { once: true });
            
            updatePlaylistDisplay();
        }
        
        // 6. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function formatTime(seconds) {
            if (!isFinite(seconds)) return '0:00';
            const min = Math.floor(seconds / 60);
            const sec = Math.floor(seconds % 60);
            return `${min}:${sec < 10 ? '0' : ''}${sec}`;
        }
        
        // 7. –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ/–ø–∞—É–∑–∞
        playPauseBtn.addEventListener('click', () => {
            if (playlistArray.length === 0) return;
            
            if (isPlaying) {
                pauseTrack();
            } else {
                playTrack();
            }
        });
        
        function playTrack() {
            if (playlistArray.length === 0) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –∞—É–¥–∏–æ –∏—Å—Ç–æ—á–Ω–∏–∫
            if (!audio.src) {
                loadTrack(currentTrackIndex);
            }
            
            // –û–∂–∏–¥–∞–µ–º, –ø–æ–∫–∞ –∞—É–¥–∏–æ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é
            if (audio.readyState < 2) {
                audio.addEventListener('canplay', function onCanPlay() {
                    audio.removeEventListener('canplay', onCanPlay);
                    actuallyPlay();
                });
            } else {
                actuallyPlay();
            }
            
            function actuallyPlay() {
                audio.play().then(() => {
                    isPlaying = true;
                    playPauseBtn.textContent = '‚è∏';
                    playPauseBtn.setAttribute('title', translations[currentLang].pauseBtnTitle);
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
                    visualizer.classList.add('active');
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
                    if (!audioContext) {
                        initVisualizer();
                    }
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
                    if (!animationFrameId) {
                        drawVisualizer();
                    }
                }).catch(error => {
                    console.error("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:", error);
                    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞, –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–µ–∫ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Å–Ω–æ–≤–∞
                    loadTrack(currentTrackIndex);
                    setTimeout(() => playTrack(), 100);
                });
            }
        }
        
        function pauseTrack() {
            if (!audio.src) return;
            
            audio.pause();
            isPlaying = false;
            playPauseBtn.textContent = '‚ñ∂';
            playPauseBtn.setAttribute('title', translations[currentLang].playBtnTitle);
            
            // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
            visualizer.classList.remove('active');
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
                animationFrameId = null;
            }
        }
        
        // 8. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        function setupProgressBarDrag() {
            let isDragging = false;
            
            // –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            progressBar.addEventListener('mousedown', startDrag);
            progressBar.addEventListener('touchstart', startDrag);
            
            // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            
            // –ö–æ–Ω–µ—Ü –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
            
            function startDrag(e) {
                if (playlistArray.length === 0) return;
                
                isDragging = true;
                progressBar.classList.add('dragging');
                updateProgress(e);
                
                // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
                e.preventDefault();
            }
            
            function drag(e) {
                if (!isDragging) return;
                updateProgress(e);
            }
            
            function endDrag() {
                isDragging = false;
                progressBar.classList.remove('dragging');
            }
            
            function updateProgress(e) {
                if (playlistArray.length === 0 || !audio.duration || !isFinite(audio.duration)) return;
                
                // –ü–æ–ª—É—á–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–ª–∏–∫–∞/–∫–∞—Å–∞–Ω–∏—è
                const clientX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                const progressBarRect = progressBar.getBoundingClientRect();
                
                // –í—ã—á–∏—Å–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                let clickX = clientX - progressBarRect.left;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                clickX = Math.max(0, Math.min(clickX, progressBarRect.width));
                
                // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç
                const percent = clickX / progressBarRect.width;
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤–æ–µ –≤—Ä–µ–º—è
                audio.currentTime = percent * audio.duration;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                const progressPercent = percent * 100;
                progress.style.width = `${progressPercent}%`;
                currentTimeEl.textContent = formatTime(audio.currentTime);
            }
        }
        
        // 9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏
        audio.addEventListener('timeupdate', () => {
            if (audio.duration && isFinite(audio.duration) && !isDraggingProgress) {
                const progressPercent = (audio.currentTime / audio.duration) * 100;
                progress.style.width = `${progressPercent}%`;
                currentTimeEl.textContent = formatTime(audio.currentTime);
            }
        });
        
        // 10. –°–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫ —Å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ—Ö–æ–¥–æ–º
        nextBtn.addEventListener('click', () => {
            if (playlistArray.length === 0) return;
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç—Ä–µ–∫—É
            currentTrackIndex = (currentTrackIndex + 1) % playlistArray.length;
            loadTrack(currentTrackIndex);
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –Ω–æ–≤—ã–π —Ç—Ä–µ–∫
            playTrack();
        });
        
        // 11. –ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫ —Å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ—Ö–æ–¥–æ–º
        prevBtn.addEventListener('click', () => {
            if (playlistArray.length === 0) return;
            
            // –ï—Å–ª–∏ —Ç—Ä–µ–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –±–æ–ª–µ–µ 3 —Å–µ–∫—É–Ω–¥, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ–∫—É—â–∏–π
            if (audio.currentTime > 3) {
                audio.currentTime = 0;
                if (isPlaying) {
                    audio.play();
                }
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Ç—Ä–µ–∫—É
            currentTrackIndex = (currentTrackIndex - 1 + playlistArray.length) % playlistArray.length;
            loadTrack(currentTrackIndex);
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –Ω–æ–≤—ã–π —Ç—Ä–µ–∫
            playTrack();
        });
        
        // 12. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—Ä–µ–∫–∞ - –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É
        audio.addEventListener('ended', () => {
            if (isLooping) {
                // –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω –ø–æ–≤—Ç–æ—Ä, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ç–µ–∫—É—â–∏–π —Ç—Ä–µ–∫ –∑–∞–Ω–æ–≤–æ
                audio.currentTime = 0;
                audio.play();
            } else {
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç—Ä–µ–∫—É
                nextBtn.click();
            }
        });
        
        // 13. –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
        volumeSlider.addEventListener('input', () => {
            const volume = volumeSlider.value / 100;
            audio.volume = volume;
            volumeValue.textContent = `${volumeSlider.value}%`;
        });
        
        // 14. –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
        function updateSpeedDisplay() {
            speedDisplay.textContent = `${playbackRate.toFixed(1)}x`;
            audio.playbackRate = playbackRate;
        }
        
        speedDownBtn.addEventListener('click', () => {
            if (playbackRate > 0.5) {
                playbackRate -= 0.1;
                updateSpeedDisplay();
            }
        });
        
        speedUpBtn.addEventListener('click', () => {
            if (playbackRate < 2.0) {
                playbackRate += 0.1;
                updateSpeedDisplay();
            }
        });
        
        // 15. –†–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞
        loopBtn.addEventListener('click', () => {
            isLooping = !isLooping;
            loopBtn.classList.toggle('active');
            loopBtn.setAttribute('title', isLooping ? 
                translations[currentLang].loopBtnOffTitle : 
                translations[currentLang].loopBtnTitle);
        });
        
        // 16. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
        function initVisualizer() {
            try {
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                if (audioContext) {
                    audioContext.close();
                }
                
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                const source = audioContext.createMediaElementSource(audio);
                
                source.connect(analyser);
                analyser.connect(audioContext.destination);
                
                analyser.fftSize = 128; // –£–º–µ–Ω—å—à–∞–µ–º –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                bufferLength = analyser.frequencyBinCount;
                dataArray = new Uint8Array(bufferLength);
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä canvas
                visualizer.width = window.innerWidth;
                visualizer.height = window.innerHeight;
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä–∞:", e);
            }
        }
        
        // 17. –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
        function drawVisualizer() {
            if (!analyser || !isPlaying) {
                animationFrameId = null;
                return;
            }
            
            animationFrameId = requestAnimationFrame(drawVisualizer);
            
            analyser.getByteFrequencyData(dataArray);
            
            // –ó–∞–ª–∏–≤–∫–∞ —Ñ–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
            if (currentTheme === 'christmas') {
                visualizerCtx.fillStyle = 'rgba(10, 46, 56, 0.1)'; // –ó–µ–ª–µ–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π —Ç–µ–º—ã
            } else {
                visualizerCtx.fillStyle = 'rgba(15, 12, 41, 0.1)'; // –°–∏–Ω–∏–π –æ—Ç—Ç–µ–Ω–æ–∫ –¥–ª—è –æ–±—ã—á–Ω–æ–π —Ç–µ–º—ã
            }
            visualizerCtx.fillRect(0, 0, visualizer.width, visualizer.height);
            
            const barWidth = (visualizer.width / bufferLength) * 2.0; // –£–º–µ–Ω—å—à–∞–µ–º —à–∏—Ä–∏–Ω—É –±–∞—Ä–æ–≤
            let barHeight;
            let x = 0;
            
            for (let i = 0; i < bufferLength; i++) {
                barHeight = dataArray[i] * 1.2; // –£–º–µ–Ω—å—à–∞–µ–º –≤—ã—Å–æ—Ç—É –±–∞—Ä–æ–≤
                
                // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –±–∞—Ä–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
                let gradient;
                if (currentTheme === 'christmas') {
                    // –ó–µ–ª–µ–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π —Ç–µ–º—ã
                    gradient = visualizerCtx.createLinearGradient(0, 0, 0, barHeight);
                    gradient.addColorStop(0, 'rgba(76, 175, 80, 0.7)'); // –ë–æ–ª–µ–µ –∑–µ–ª–µ–Ω—ã–π
                    gradient.addColorStop(0.5, 'rgba(139, 195, 74, 0.5)');
                    gradient.addColorStop(1, 'rgba(76, 175, 80, 0.3)');
                } else {
                    // –°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –æ–±—ã—á–Ω–æ–π —Ç–µ–º—ã
                    gradient = visualizerCtx.createLinearGradient(0, 0, 0, barHeight);
                    gradient.addColorStop(0, 'rgba(0, 212, 255, 0.7)');
                    gradient.addColorStop(0.5, 'rgba(0, 136, 255, 0.5)');
                    gradient.addColorStop(1, 'rgba(0, 212, 255, 0.3)');
                }
                
                visualizerCtx.fillStyle = gradient;
                visualizerCtx.fillRect(x, visualizer.height - barHeight, barWidth, barHeight);
                
                x += barWidth + 0.5; // –£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –º–µ–∂–¥—É –±–∞—Ä–∞–º–∏
            }
        }
        
        // 18. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', handleResize);
        
        // 19. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–µ–µ—Ä–∞
        audio.volume = volumeSlider.value / 100;
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        setupProgressBarDrag();
        
        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        window.addEventListener('load', () => {
            setLanguage('ru');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
            const savedTheme = localStorage.getItem('fufelplayer_theme');
            if (savedTheme === 'christmas' || savedTheme === 'normal') {
                setTheme(savedTheme);
            } else {
                setTheme('normal');
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç (—Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É)
            loadPlaylistFromStorage();
        });
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–ª–µ–π–ª–∏—Å—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            savePlaylistToStorage();
        });
    </script>
</body>
</html>